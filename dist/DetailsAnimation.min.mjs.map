{"version":3,"sources":["DetailsAnimation.mjs"],"names":["_preOpen","_animation","_supportCSSTypedOM","_summaryElement","_summaryToggleHTML","_detailsContentElement","_detailsContentCustomElementName","_windowResizeTimeoutId","_summaryClickEventListener","_summaryMouseEnterEventListener","_summaryMouseLeaveEventListener","_detailsContentTransitionEndEventListener","_windowResizeEventListener","__classPrivateFieldSet","this","receiver","privateMap","value","has","TypeError","set","__classPrivateFieldGet","get","DetailsAnimation","HTMLDetailsElement","[object Object]","super","undefined","attributeStyleMap","_summaryClickEvent","bind","_summaryMouseEnterEvent","_summaryMouseLeaveEvent","_detailsContentTransitionEndEvent","_windowResizeEvent","summaryElement","querySelector","Error","window","tabIndex","open","getAttribute","detailsContentCustomElementName","dataset","contentElement","includes","summaryToggle","fragment","document","createDocumentFragment","nextNode","nextSibling","appendChild","detailsContentElement","createElement","insertAdjacentElement","slot","_open","_close","addEventListener","passive","removeEventListener","ev","preventDefault","preOpen","_toggleSummary","summaryToggleHTML","innerHTML","textContent","insertAdjacentHTML","setTimeout","CSS","px","scrollHeight","style","height","String","willChange","delete","timeoutId","clearTimeout","WeakMap"],"mappings":"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","file":"DetailsAnimation.min.mjs","sourcesContent":["var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, privateMap, value) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to set private field on non-instance\");\n    }\n    privateMap.set(receiver, value);\n    return value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to get private field on non-instance\");\n    }\n    return privateMap.get(receiver);\n};\nvar _preOpen, _animation, _supportCSSTypedOM, _summaryElement, _summaryToggleHTML, _detailsContentElement, _detailsContentCustomElementName, _windowResizeTimeoutId, _summaryClickEventListener, _summaryMouseEnterEventListener, _summaryMouseLeaveEventListener, _detailsContentTransitionEndEventListener, _windowResizeEventListener;\n/**\n * Animate the opening or closing process of the <details> element by Custom Elements.\n *\n * @version 1.1.0\n */\nexport default class DetailsAnimation extends HTMLDetailsElement {\n    constructor() {\n        super();\n        _preOpen.set(this, false); // アニメーションの実現のため本来の open 属性の反映タイミングは実際とは変えており、開閉処理が始まった瞬間の状態をこの変数に記録する\n        _animation.set(this, false); // アニメーション中かどうか\n        _supportCSSTypedOM.set(this, void 0); // CSS Typed Object Model に対応しているか（Chrome 66+, Chromium Edge） https://caniuse.com/mdn-api_element_attributestylemap\n        _summaryElement.set(this, null);\n        _summaryToggleHTML.set(this, void 0);\n        _detailsContentElement.set(this, null); // <details> 要素内の <summary> 要素を除くコンテンツを囲う要素\n        _detailsContentCustomElementName.set(this, 'x-details-animation-content'); // <details> 要素内の <summary> 要素を除くコンテンツを囲う要素の名前\n        _windowResizeTimeoutId.set(this, null); // window.onresize のタイマーの識別 ID（clearTimeout() で使用）\n        _summaryClickEventListener.set(this, void 0);\n        _summaryMouseEnterEventListener.set(this, void 0);\n        _summaryMouseLeaveEventListener.set(this, void 0);\n        _detailsContentTransitionEndEventListener.set(this, void 0);\n        _windowResizeEventListener.set(this, void 0);\n        __classPrivateFieldSet(this, _supportCSSTypedOM, this.attributeStyleMap !== undefined);\n        __classPrivateFieldSet(this, _summaryClickEventListener, this._summaryClickEvent.bind(this));\n        __classPrivateFieldSet(this, _summaryMouseEnterEventListener, this._summaryMouseEnterEvent.bind(this));\n        __classPrivateFieldSet(this, _summaryMouseLeaveEventListener, this._summaryMouseLeaveEvent.bind(this));\n        __classPrivateFieldSet(this, _detailsContentTransitionEndEventListener, this._detailsContentTransitionEndEvent.bind(this));\n        __classPrivateFieldSet(this, _windowResizeEventListener, this._windowResizeEvent.bind(this));\n    }\n    connectedCallback() {\n        const summaryElement = this.querySelector('summary');\n        if (summaryElement === null) {\n            throw new Error('Element <details> is missing a required instance of child element <summary>.');\n        }\n        __classPrivateFieldSet(this, _summaryElement, summaryElement);\n        if (window.HTMLDetailsElement === undefined) {\n            /* <details> 未対応ブラウザ */\n            summaryElement.tabIndex = 0;\n            this.open = this.getAttribute('open') !== null;\n        }\n        const detailsContentCustomElementName = this.dataset.contentElement;\n        if (detailsContentCustomElementName !== undefined) {\n            if (!detailsContentCustomElementName.includes('-')) {\n                throw new Error('Attribute: `data-content-element` value must contain a hyphen.');\n            }\n            __classPrivateFieldSet(this, _detailsContentCustomElementName, detailsContentCustomElementName);\n        }\n        __classPrivateFieldSet(this, _summaryToggleHTML, this.dataset.summaryToggle);\n        /* <summary> を除くノードを <div> でラップする */\n        const fragment = document.createDocumentFragment();\n        let nextNode = summaryElement.nextSibling;\n        while (nextNode !== null) {\n            fragment.appendChild(nextNode);\n            nextNode = summaryElement.nextSibling;\n        }\n        const detailsContentElement = document.createElement(__classPrivateFieldGet(this, _detailsContentCustomElementName));\n        summaryElement.insertAdjacentElement('afterend', detailsContentElement);\n        __classPrivateFieldSet(this, _detailsContentElement, detailsContentElement);\n        const contentElement = document.createElement('div');\n        contentElement.slot = 'content';\n        contentElement.appendChild(fragment);\n        detailsContentElement.appendChild(contentElement);\n        const open = this.open;\n        __classPrivateFieldSet(this, _preOpen, open);\n        if (open) {\n            this._open();\n        }\n        else {\n            this._close();\n        }\n        summaryElement.addEventListener('click', __classPrivateFieldGet(this, _summaryClickEventListener));\n        summaryElement.addEventListener('mouseenter', __classPrivateFieldGet(this, _summaryMouseEnterEventListener), { passive: true });\n        summaryElement.addEventListener('mouseleave', __classPrivateFieldGet(this, _summaryMouseLeaveEventListener), { passive: true });\n        detailsContentElement.addEventListener('transitionend', __classPrivateFieldGet(this, _detailsContentTransitionEndEventListener), { passive: true });\n    }\n    disconnectedCallback() {\n        const summaryElement = __classPrivateFieldGet(this, _summaryElement);\n        const detailsContentElement = __classPrivateFieldGet(this, _detailsContentElement);\n        summaryElement.removeEventListener('click', __classPrivateFieldGet(this, _summaryClickEventListener));\n        summaryElement.removeEventListener('mouseenter', __classPrivateFieldGet(this, _summaryMouseEnterEventListener));\n        summaryElement.removeEventListener('mouseleave', __classPrivateFieldGet(this, _summaryMouseLeaveEventListener));\n        detailsContentElement.removeEventListener('transitionend', __classPrivateFieldGet(this, _detailsContentTransitionEndEventListener));\n        window.removeEventListener('resize', __classPrivateFieldGet(this, _windowResizeEventListener));\n    }\n    /**\n     * <summary> 要素をクリックしたときの処理\n     *\n     * @param {Event} ev - Event\n     */\n    _summaryClickEvent(ev) {\n        ev.preventDefault();\n        const preOpen = !__classPrivateFieldGet(this, _preOpen);\n        __classPrivateFieldSet(this, _preOpen, preOpen);\n        this._toggleSummary();\n        if (!__classPrivateFieldGet(this, _animation) && preOpen) {\n            this.open = true;\n        }\n        if (preOpen) {\n            this._open();\n        }\n        else {\n            this._close();\n        }\n        __classPrivateFieldSet(this, _animation, true);\n    }\n    /**\n     * <summary> 要素の表示を切り替える\n     */\n    _toggleSummary() {\n        const summaryToggleHTML = __classPrivateFieldGet(this, _summaryToggleHTML);\n        if (summaryToggleHTML !== undefined) {\n            const summaryElement = __classPrivateFieldGet(this, _summaryElement);\n            __classPrivateFieldSet(this, _summaryToggleHTML, summaryElement.innerHTML);\n            summaryElement.textContent = '';\n            summaryElement.insertAdjacentHTML('beforeend', summaryToggleHTML);\n        }\n    }\n    /**\n     * コンテンツエリアを開く処理\n     */\n    _open() {\n        setTimeout(() => {\n            if (__classPrivateFieldGet(this, _supportCSSTypedOM)) {\n                __classPrivateFieldGet(this, _detailsContentElement).attributeStyleMap.set('height', CSS.px(__classPrivateFieldGet(this, _detailsContentElement).scrollHeight));\n            }\n            else {\n                __classPrivateFieldGet(this, _detailsContentElement).style.height = `${String(__classPrivateFieldGet(this, _detailsContentElement).scrollHeight)}px`;\n            }\n        }, 0); // TODO 最初から open 状態の場合、初期状態では高さが正常に取得できないための回避策\n        window.addEventListener('resize', __classPrivateFieldGet(this, _windowResizeEventListener), { passive: true });\n    }\n    /**\n     * コンテンツエリアを閉じる処理\n     */\n    _close() {\n        if (__classPrivateFieldGet(this, _supportCSSTypedOM)) {\n            __classPrivateFieldGet(this, _detailsContentElement).attributeStyleMap.set('height', '0');\n        }\n        else {\n            __classPrivateFieldGet(this, _detailsContentElement).style.height = '0';\n        }\n        window.removeEventListener('resize', __classPrivateFieldGet(this, _windowResizeEventListener));\n    }\n    /**\n     * <summary> 要素上にマウスカーソルが入ったときの処理\n     */\n    _summaryMouseEnterEvent() {\n        if (__classPrivateFieldGet(this, _supportCSSTypedOM)) {\n            __classPrivateFieldGet(this, _detailsContentElement).attributeStyleMap.set('will-change', 'height');\n        }\n        else {\n            __classPrivateFieldGet(this, _detailsContentElement).style.willChange = 'height';\n        }\n    }\n    /**\n     * <summary> 要素上からマウスカーソルが外れたときの処理\n     */\n    _summaryMouseLeaveEvent() {\n        if (__classPrivateFieldGet(this, _supportCSSTypedOM)) {\n            __classPrivateFieldGet(this, _detailsContentElement).attributeStyleMap.delete('will-change');\n        }\n        else {\n            __classPrivateFieldGet(this, _detailsContentElement).style.willChange = '';\n        }\n    }\n    /**\n     * 開閉アニメーションが終了したときの処理\n     */\n    _detailsContentTransitionEndEvent() {\n        __classPrivateFieldSet(this, _animation, false);\n        if (!__classPrivateFieldGet(this, _preOpen)) {\n            this.open = false;\n        }\n    }\n    /**\n     * ウィンドウサイズを変更した時の処理\n     */\n    _windowResizeEvent() {\n        const timeoutId = __classPrivateFieldGet(this, _windowResizeTimeoutId);\n        if (timeoutId !== null) {\n            clearTimeout(timeoutId);\n        }\n        __classPrivateFieldSet(this, _windowResizeTimeoutId, setTimeout(() => {\n            const detailsContentElement = __classPrivateFieldGet(this, _detailsContentElement);\n            if (__classPrivateFieldGet(this, _supportCSSTypedOM)) {\n                detailsContentElement.attributeStyleMap.set('height', 'auto');\n                detailsContentElement.attributeStyleMap.set('height', CSS.px(detailsContentElement.scrollHeight));\n            }\n            else {\n                detailsContentElement.style.height = 'auto';\n                detailsContentElement.style.height = `${String(detailsContentElement.scrollHeight)}px`;\n            }\n        }, 100));\n    }\n}\n_preOpen = new WeakMap(), _animation = new WeakMap(), _supportCSSTypedOM = new WeakMap(), _summaryElement = new WeakMap(), _summaryToggleHTML = new WeakMap(), _detailsContentElement = new WeakMap(), _detailsContentCustomElementName = new WeakMap(), _windowResizeTimeoutId = new WeakMap(), _summaryClickEventListener = new WeakMap(), _summaryMouseEnterEventListener = new WeakMap(), _summaryMouseLeaveEventListener = new WeakMap(), _detailsContentTransitionEndEventListener = new WeakMap(), _windowResizeEventListener = new WeakMap();\n"]}